<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pySpice.parser.parseline &mdash; pySpice 0.01 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.01',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="pySpice 0.01 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pySpice.parser.parseline</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pySpice.global_data</span>
<span class="kn">from</span> <span class="nn">pySpice.element_class</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pySpice.parser.utils</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">pdb</span>

<div class="viewcode-block" id="parse_element"><a class="viewcode-back" href="../../../pySpice.parser.html#pySpice.parser.parseline.parse_element">[docs]</a><span class="k">def</span> <span class="nf">parse_element</span><span class="p">(</span><span class="n">raw_line</span><span class="p">,</span> <span class="n">node_dim</span><span class="p">,</span> <span class="n">branch_dim</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Parse a Circuit Element</span>

<span class="sd">    :param raw_line: a string represent a element describe in Netlist</span>
<span class="sd">    :param node_dim: The upper layer of this function retains a state counting how many node this circuit have. This value is passed into this function and here it decide whether to modify it or not basing on if encounter new nodes</span>
<span class="sd">    :param branch_dim: similar to node_dim, the variabel counting how many linkages should appear in the matrix</span>
<span class="sd">    :return: </span>
<span class="sd">        + node_dim</span>
<span class="sd">        + branch_dim</span>
<span class="sd">	&#39;&#39;&#39;</span>

	<span class="n">line</span> <span class="o">=</span> <span class="n">raw_line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

	<span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span>
		<span class="n">value</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
		<span class="n">ext_p</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
		<span class="n">ext_n</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
		<span class="n">loc_p</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">ext_p</span><span class="p">,</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_n</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">ext_n</span><span class="p">,</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">catagory</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span>
		<span class="n">temp</span> <span class="o">=</span> <span class="n">ele_2port</span><span class="p">(</span><span class="n">catagory</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">loc_p</span><span class="p">,</span><span class="n">loc_n</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
		<span class="n">pySpice</span><span class="o">.</span><span class="n">global_data</span><span class="o">.</span><span class="n">ELEMENT_DICT</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>

	<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span>
		<span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">ext_p</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
		<span class="n">ext_n</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
		<span class="n">ext_ctrl_p</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
		<span class="n">ext_ctrl_n</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
		<span class="n">loc_p</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">ext_p</span><span class="p">,</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_n</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">ext_n</span><span class="p">,</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_ctrl_p</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">ext_ctrl_p</span><span class="p">,</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_ctrl_n</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">ext_ctrl_n</span><span class="p">,</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">brch_num</span><span class="p">,</span> <span class="n">branch_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">branch_dim</span><span class="p">)</span>
		<span class="n">temp</span> <span class="o">=</span> <span class="n">vcvs</span><span class="p">(</span><span class="n">loc_ctrl_p</span><span class="p">,</span> <span class="n">loc_ctrl_n</span><span class="p">,</span> <span class="n">brch_num</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">loc_p</span><span class="p">,</span> <span class="n">loc_n</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
		<span class="n">pySpice</span><span class="o">.</span><span class="n">global_data</span><span class="o">.</span><span class="n">ELEMENT_DICT</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>

	<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
		<span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">ext_p</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
		<span class="n">ext_n</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
		<span class="n">ext_ctrl_name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
		<span class="n">loc_p</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">ext_p</span><span class="p">,</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_n</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">ext_n</span><span class="p">,</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_ctrl_brch</span><span class="p">,</span> <span class="n">branch_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">ext_ctrl_name</span><span class="p">,</span> <span class="n">branch_dim</span><span class="p">)</span>
		<span class="n">temp</span> <span class="o">=</span> <span class="n">cccs</span><span class="p">(</span><span class="n">loc_ctrl_brch</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">loc_p</span><span class="p">,</span> <span class="n">loc_n</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
		<span class="n">pySpice</span><span class="o">.</span><span class="n">global_data</span><span class="o">.</span><span class="n">ELEMENT_DICT</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>

	<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span>
		<span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">ext_p</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
		<span class="n">ext_n</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
		<span class="n">ext_ctrl_p</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
		<span class="n">ext_ctrl_n</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
		<span class="n">loc_p</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">ext_p</span><span class="p">,</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_n</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">ext_n</span><span class="p">,</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_ctrl_p</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">ext_ctrl_p</span><span class="p">,</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_ctrl_n</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">ext_ctrl_n</span><span class="p">,</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">temp</span> <span class="o">=</span> <span class="n">vccs</span><span class="p">(</span><span class="n">loc_ctrl_p</span><span class="p">,</span> <span class="n">loc_ctrl_n</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">loc_p</span><span class="p">,</span> <span class="n">loc_n</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
		<span class="n">pySpice</span><span class="o">.</span><span class="n">global_data</span><span class="o">.</span><span class="n">ELEMENT_DICT</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>

	<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;h&#39;</span><span class="p">:</span>
		<span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">loc_p</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_n</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_ctrl_brch</span><span class="p">,</span> <span class="n">branch_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">branch_dim</span><span class="p">)</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
		<span class="n">loc_brch</span><span class="p">,</span> <span class="n">branch_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">branch_dim</span><span class="p">)</span>
		<span class="n">temp</span> <span class="o">=</span> <span class="n">ccvs</span><span class="p">(</span><span class="n">loc_brch</span><span class="p">,</span> <span class="n">loc_ctrl_brch</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">loc_p</span><span class="p">,</span> <span class="n">loc_n</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
		<span class="n">pySpice</span><span class="o">.</span><span class="n">global_data</span><span class="o">.</span><span class="n">ELEMENT_DICT</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>
		
	<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span>
		<span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">loc_p</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_n</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
		<span class="k">if</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span>
			<span class="n">temp</span> <span class="o">=</span> <span class="n">capacitor</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">loc_p</span><span class="p">,</span> <span class="n">loc_n</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">loc_brch</span><span class="p">,</span> <span class="n">branch_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">branch_dim</span><span class="p">)</span> 
			<span class="n">temp</span> <span class="o">=</span> <span class="n">inductor</span><span class="p">(</span><span class="n">loc_brch</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">loc_p</span><span class="p">,</span> <span class="n">loc_n</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
			
		<span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ic&#39;</span><span class="p">):</span>
			<span class="n">temp</span><span class="o">.</span><span class="n">ic</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">))[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
			<span class="c1">#current only support format like: IC=3v</span>
		<span class="n">pySpice</span><span class="o">.</span><span class="n">global_data</span><span class="o">.</span><span class="n">ELEMENT_DICT</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>

	<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span>
		<span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">loc_p</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_n</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">model</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
		<span class="n">temp</span> <span class="o">=</span> <span class="n">diode</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">loc_p</span><span class="p">,</span> <span class="n">loc_n</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;ic=[0-9]*\?.[0-9]*[numkxg]?&quot;</span><span class="p">,</span> <span class="n">raw_line</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
		<span class="k">if</span> <span class="n">m</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">ic</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
			<span class="n">temp</span><span class="o">.</span><span class="n">ic</span> <span class="o">=</span> <span class="n">ic</span>
		<span class="n">pySpice</span><span class="o">.</span><span class="n">global_data</span><span class="o">.</span><span class="n">ELEMENT_DICT</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>

	<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>
		<span class="c1">#current only support w/l parmeter</span>
		<span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">loc_d</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_g</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_s</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_b</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">model</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
		<span class="n">temp</span> <span class="o">=</span> <span class="n">mos</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">loc_d</span><span class="p">,</span> <span class="n">loc_g</span><span class="p">,</span> <span class="n">loc_s</span><span class="p">,</span> <span class="n">loc_b</span><span class="p">)</span>
		<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;l=[0-9]*\.?[0-9]*[numkxg]?&quot;</span><span class="p">,</span><span class="n">raw_line</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
		<span class="k">if</span> <span class="n">m</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">temp</span><span class="o">.</span><span class="n">l</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;w=[0-9]*\.?[0-9]*[numkxg]?&quot;</span><span class="p">,</span><span class="n">raw_line</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
		<span class="k">if</span> <span class="n">m</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">temp</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">pySpice</span><span class="o">.</span><span class="n">global_data</span><span class="o">.</span><span class="n">ELEMENT_DICT</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>

	<span class="k">elif</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;v&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">):</span>
		<span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">loc_p</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="n">loc_n</span><span class="p">,</span> <span class="n">node_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">node_dim</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span>
			<span class="n">loc_brch</span><span class="p">,</span> <span class="n">branch_dim</span> <span class="o">=</span> <span class="n">address_transform</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">branch_dim</span><span class="p">)</span>
			<span class="n">temp</span> <span class="o">=</span> <span class="n">v_src</span><span class="p">(</span><span class="n">loc_brch</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">loc_p</span><span class="p">,</span> <span class="n">loc_n</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">temp</span> <span class="o">=</span> <span class="n">i_src</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">loc_p</span><span class="p">,</span> <span class="n">loc_n</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;dc&#39;</span><span class="p">:</span>
				<span class="n">temp</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;-?[0-9]*\.?[0-9]*[numkxgNUMKXG]?&quot;</span><span class="p">,</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
				<span class="k">if</span> <span class="n">m</span><span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
					<span class="n">temp</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

			<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;ac\s+[0-9]+\.?[0-9]*[numkxg]?\s+[0-9]*\.?[0-9]*&quot;</span><span class="p">,</span> <span class="n">raw_line</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
			<span class="k">if</span> <span class="n">m</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
				<span class="n">buf</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="n">num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
				<span class="n">ac_mag</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
				<span class="n">ac_phase</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="k">if</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
					<span class="n">ac_phase</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
				<span class="n">real</span> <span class="o">=</span> <span class="n">ac_mag</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">ac_phase</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
				<span class="n">imag</span> <span class="o">=</span> <span class="n">ac_mag</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">ac_phase</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
				<span class="n">temp</span><span class="o">.</span><span class="n">ac</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">real</span><span class="p">,</span> <span class="n">imag</span><span class="p">)</span>
			<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;sin|exp|pulse|stair&quot;</span><span class="p">,</span><span class="n">raw_line</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
			<span class="k">if</span> <span class="n">m</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
				<span class="n">buf</span> <span class="o">=</span> <span class="n">raw_line</span><span class="o">.</span><span class="n">lower</span><span class="p">()[</span><span class="n">m</span><span class="o">.</span><span class="n">span</span><span class="p">()[</span><span class="mi">0</span><span class="p">]:]</span> <span class="c1">#assume this part must appear last</span>
				<span class="n">tf</span> <span class="o">=</span> <span class="n">parse_timefunc</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
				<span class="n">temp</span><span class="o">.</span><span class="n">tran</span> <span class="o">=</span> <span class="n">tf</span>
		<span class="n">pySpice</span><span class="o">.</span><span class="n">global_data</span><span class="o">.</span><span class="n">ELEMENT_DICT</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>
				
	<span class="k">return</span> <span class="n">node_dim</span><span class="p">,</span> <span class="n">branch_dim</span></div>

	
<div class="viewcode-block" id="parse_timefunc"><a class="viewcode-back" href="../../../pySpice.parser.html#pySpice.parser.parseline.parse_timefunc">[docs]</a><span class="k">def</span> <span class="nf">parse_timefunc</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Parsing time-varient source into internal representation</span>

<span class="sd">	In transient analysis, stimulates may take the form like PULSE, SIN, etc.This sub-utility to *parseline* function extract these part into designed data structures.</span>

<span class="sd">	:param string: a slice of the element string like: &quot;SIN(-1 1 1M)&quot;</span>
<span class="sd">    </span>
<span class="sd">	:return: a instance of the respctive data structure.</span>
<span class="sd">    </span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;pulse&#39;</span><span class="p">,</span><span class="n">string</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
		<span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>
		<span class="n">temp</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">temp</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
			<span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="n">temp</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
			<span class="n">temp</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
			<span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">[:</span><span class="n">temp</span><span class="p">]</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="c1">#here the time has a unit &#39;s&#39;</span>
		<span class="n">item</span> <span class="o">=</span> <span class="n">pulse_src</span><span class="p">(</span><span class="n">extract</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">extract</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">extract</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">2</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">extract</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">3</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">extract</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">4</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span><span class="n">extract</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">5</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">extract</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">6</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
		<span class="k">return</span> <span class="n">item</span>

	<span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;sin&#39;</span><span class="p">,</span><span class="n">string</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
		<span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
		<span class="n">temp</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">temp</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
			<span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="n">temp</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
			<span class="n">temp</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
			<span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">[:</span><span class="n">temp</span><span class="p">]</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="n">item</span> <span class="o">=</span> <span class="n">sin_src</span><span class="p">(</span><span class="n">extract</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">extract</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">extract</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
		<span class="k">return</span> <span class="n">item</span>

	<span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;exp&#39;</span><span class="p">,</span><span class="n">string</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
		<span class="k">print</span> <span class="s2">&quot;exp haven&#39;t support&quot;</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

	<span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;stair&#39;</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
		<span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>
		<span class="n">temp</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">temp</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
			<span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="n">temp</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
			<span class="n">temp</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
			<span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">[:</span><span class="n">temp</span><span class="p">]</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="n">item</span> <span class="o">=</span> <span class="n">stair_src</span><span class="p">(</span><span class="n">extract</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">extract</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">extract</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">2</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
		<span class="k">return</span> <span class="n">item</span>

	<span class="k">else</span><span class="p">:</span>
		<span class="k">print</span> <span class="s2">&quot;Unrecognied Time-Function Indep. Source&quot;</span>
		<span class="k">print</span> <span class="s2">&quot;error raised, exiting now&quot;</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>
			
			

<div class="viewcode-block" id="parse_ctrl"><a class="viewcode-back" href="../../../pySpice.parser.html#pySpice.parser.parseline.parse_ctrl">[docs]</a><span class="k">def</span> <span class="nf">parse_ctrl</span><span class="p">(</span><span class="n">raw_line</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Parsing Control Command in SPICE</span>

<span class="sd">	:param raw_line: a string represent a control command (start with a dot) describe in Netlist</span>
<span class="sd">	:return: </span>
<span class="sd">		Modify the *SETTING_LIST*, *ANALYSIS_LSIT*, *PRINT_DICT* in global_data </span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">line</span> <span class="o">=</span> <span class="n">raw_line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
	<span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;options&#39;</span><span class="p">:</span>
		<span class="k">pass</span>
		
	<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;nodeset&#39;</span><span class="p">:</span>
		<span class="k">pass</span>

	<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;ic&#39;</span><span class="p">:</span>
		<span class="k">pass</span>

	<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;op&#39;</span><span class="p">:</span>
		<span class="n">pySpice</span><span class="o">.</span><span class="n">global_data</span><span class="o">.</span><span class="n">ANALYSIS_LIST</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
		
	<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;dc&#39;</span><span class="p">:</span>
		<span class="n">start_l</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
		<span class="n">stop_l</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
		<span class="n">step_l</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
		<span class="n">temp_gen</span> <span class="o">=</span> <span class="n">linear_generator</span><span class="p">(</span><span class="n">start_l</span><span class="p">,</span> <span class="n">stop_l</span><span class="p">,</span> <span class="n">step_l</span><span class="p">)</span>		
		<span class="n">temp</span> <span class="o">=</span> <span class="n">analysis_dc</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">temp_gen</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
			<span class="n">temp</span><span class="o">.</span><span class="n">double_scan_flag</span> <span class="o">=</span> <span class="mi">1</span>
			<span class="n">temp</span><span class="o">.</span><span class="n">generator2</span> <span class="o">=</span> <span class="n">linear_generator</span><span class="p">(</span><span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">7</span><span class="p">]),</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">8</span><span class="p">]))</span>
			<span class="n">temp</span><span class="o">.</span><span class="n">swp_src2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
		<span class="n">pySpice</span><span class="o">.</span><span class="n">global_data</span><span class="o">.</span><span class="n">ANALYSIS_LIST</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
			
	<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;ac&#39;</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;lin&#39;</span><span class="p">:</span>
			<span class="n">start_l</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
			<span class="n">stop_l</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
			<span class="n">step_l</span> <span class="o">=</span> <span class="p">(</span><span class="n">stop_l</span> <span class="o">-</span> <span class="n">start_l</span><span class="p">)</span><span class="o">/</span><span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
			<span class="n">temp_gen</span> <span class="o">=</span> <span class="n">linear_generator</span><span class="p">(</span><span class="n">start_l</span><span class="p">,</span> <span class="n">stop_l</span><span class="p">,</span> <span class="n">step_l</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;oct&#39;</span><span class="p">:</span>
			<span class="n">start_l</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
			<span class="n">stop_l</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
			<span class="n">step_l</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
			<span class="n">temp_gen</span> <span class="o">=</span> <span class="n">oct_generator</span><span class="p">(</span><span class="n">start_l</span><span class="p">,</span> <span class="n">stop_l</span><span class="p">,</span> <span class="n">step_l</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;dec&#39;</span><span class="p">:</span>
			<span class="n">start_l</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
			<span class="n">stop_l</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
			<span class="n">step_l</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
			<span class="n">temp_gen</span> <span class="o">=</span> <span class="n">dec_generator</span><span class="p">(</span><span class="n">start_l</span><span class="p">,</span> <span class="n">stop_l</span><span class="p">,</span> <span class="n">step_l</span><span class="p">)</span>
		<span class="n">temp</span> <span class="o">=</span> <span class="n">analysis_ac</span><span class="p">(</span><span class="n">temp_gen</span><span class="p">)</span>
		<span class="n">pySpice</span><span class="o">.</span><span class="n">global_data</span><span class="o">.</span><span class="n">ANALYSIS_LIST</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

	<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;tran&#39;</span><span class="p">:</span>
		<span class="n">start_l</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="n">stop_l</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">step_l</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">temp</span> <span class="o">=</span> <span class="n">analysis_tran</span><span class="p">(</span><span class="n">linear_generator</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop_l</span><span class="p">,</span> <span class="n">step_l</span><span class="p">),</span> <span class="n">step_l</span><span class="p">)</span>
		<span class="k">if</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;uic&#39;</span><span class="p">,</span> <span class="n">raw_line</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">):</span>
			<span class="n">temp</span><span class="o">.</span><span class="n">uic_flag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;uic&#39;</span><span class="p">:</span>
				<span class="n">temp</span><span class="o">.</span><span class="n">show_start</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;uic&#39;</span><span class="p">:</span>
					<span class="n">temp</span><span class="o">.</span><span class="n">max_step</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">pySpice</span><span class="o">.</span><span class="n">global_data</span><span class="o">.</span><span class="n">ANALYSIS_LIST</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

	<span class="k">elif</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;print&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;plot&#39;</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
			<span class="n">temp</span> <span class="o">=</span> <span class="n">print_item</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ac&#39;</span><span class="p">:</span>
					<span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
					<span class="n">temp</span><span class="o">.</span><span class="n">ac_flag</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
				<span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
					<span class="n">temp</span><span class="o">.</span><span class="n">op_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
					<span class="n">temp</span><span class="o">.</span><span class="n">op_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
					<span class="n">temp</span><span class="o">.</span><span class="n">op_flag</span> <span class="o">=</span> <span class="mi">1</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">temp</span><span class="o">.</span><span class="n">op_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

			<span class="k">elif</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ac&#39;</span><span class="p">:</span>
					<span class="n">item</span>  <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;()&#39;</span><span class="p">)</span>
					<span class="n">item</span><span class="o">.</span><span class="n">ac_flag</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;()&#39;</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span>
					<span class="k">print</span> <span class="s2">&quot;Current not support print device current except current source&quot;</span>
					<span class="k">print</span> <span class="s2">&quot; Raise error&quot;</span>
					<span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">temp</span><span class="o">.</span><span class="n">op_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
					<span class="n">temp</span><span class="o">.</span><span class="n">op_flag</span> <span class="o">=</span> <span class="mi">0</span>

			<span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;dc&#39;</span><span class="p">:</span>
				<span class="n">pySpice</span><span class="o">.</span><span class="n">global_data</span><span class="o">.</span><span class="n">PRINT_DICT</span><span class="p">[</span><span class="s1">&#39;dc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;tran&#39;</span><span class="p">:</span>
				<span class="n">pySpice</span><span class="o">.</span><span class="n">global_data</span><span class="o">.</span><span class="n">PRINT_DICT</span><span class="p">[</span><span class="s1">&#39;tran&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ac&#39;</span><span class="p">:</span>
				<span class="n">pySpice</span><span class="o">.</span><span class="n">global_data</span><span class="o">.</span><span class="n">PRINT_DICT</span><span class="p">[</span><span class="s1">&#39;ac&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">print</span> <span class="s1">&#39;error&#39;</span></div>

</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Wenqi Yin.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
    </div>

    

    
  </body>
</html>